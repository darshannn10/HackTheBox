# Challenge Description
Can you find a way to login as the administrator of the website and free nginxatsu?

# Analysis
When connecting to the given <IP address, Port>, a simple login form is presented:

![Login Page](https://user-images.githubusercontent.com/87711310/211150233-62e9fcdf-7900-4237-b13b-b8000381850c.png)

The first things I tried was to supply `default` credentials and to test the web application for SQL injection vulnerabilities, but nothing worked.

Then, I created an account for a random user and I logged in the web application using the chosen username and password.

Once logged in, the web app presented me a form that allows the user to generate automatically an [nginx](https://www.nginx.com/resources/glossary/nginx/) config file.

![nginx-config](https://user-images.githubusercontent.com/87711310/211150234-11855693-ca96-4ed2-8762-5cfca1445038.png)

After submitting the form, an icon (representing the file just created) appeared at the bottom of the web page.

![nginx-3](https://user-images.githubusercontent.com/87711310/211150235-dc1bdd98-9191-452f-8dd0-2f7b9bbe5af1.png)

By clicking on the icon was possible to have a look at the content of the config file. At first glance, the content of the file was pretty standard, except for a comment tha caught my attention.

![nginx-4](https://user-images.githubusercontent.com/87711310/211150237-a040a3d0-b945-4f91-a8ab-1264b59397e6.png)

The comment revealed me the existence of a directory “/storage” inside the web server. Therefore, I tried to verify immediately the existence of that directory.

By navigating to the page:
```
http://<server_ip>:<port>/storage
```

it was possible to access a list of various nginx config files, but the most interesting thing listed was a file that seemed a compressed database backup.

![nginx-5](https://user-images.githubusercontent.com/87711310/211150238-36f2b365-c645-42d2-8be7-6e761ab1a97e.png)

Once downloaded (by using [wget](https://www.gnu.org/software/wget/)) and extracted, it was clear that the file was a sqlite database backup. In order to see the content of the database backup I used [Sqlitebrowser](https://sqlitebrowser.org/), that allowed me to retrieve the following table:

![nginx-6](https://user-images.githubusercontent.com/87711310/211150239-de25c176-be33-489b-a795-1e9ae07c72f6.png)

It is possible to see that the database contained some usernames and some hashed passwords. Moreover, it is possible to notice that the first user probably is the administrator of the web site.

Once retrieved the hashes, I used [Hashid](https://psypanda.github.io/hashID/) in order to discover the algorithm used to generate them:

![nginx-7](https://user-images.githubusercontent.com/87711310/211150240-d92d8ab9-ca57-4eb1-9e45-6fea4064f7e0.png)

It is possible to see that hasid suggested that the hashes were generated by using `MD2` or `MD5`.

I used `Hashcat`, and in particular a `dictionary attack`, in order to crack the passwords.
```
hashcat -a 0 -m 0 crackme.txt /usr/share/seclists/Passwords/Leaked-Databases/md5decryptor-uk.txt -r /usr/share/hashcat/rules/best64.rule
```

I was able to crack only the password of the first user (the `admin` password).

![nginx-8](https://user-images.githubusercontent.com/87711310/211150242-6c01cf8c-dd1f-44af-8fe0-8eff564a0601.png)

Having the admin email and the `admin` password, I was able to login in the web app again, with the admin’s credentials. Once logged in as the admin, the flag was displayed.

![nginx-9](https://user-images.githubusercontent.com/87711310/211150232-4269f3b4-b965-43c9-a125-a32e939b8acc.png)

